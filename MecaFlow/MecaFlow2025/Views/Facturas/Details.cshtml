@model MecaFlow2025.Models.Factura
@using System.Globalization
@{
    ViewData["Title"] = $"Detalle Factura #{Model.FacturaId}";
    string montoCR = Model.MontoTotal.ToString("C", new CultureInfo("es-CR"));
    Layout = null;
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

<style>
    body {
        background: linear-gradient(135deg, #141e30, #243b55);
        background-size: 400% 400%;
        color: #fff;
    }

    .details-card {
        background-color: rgba(33, 37, 41, 0.9);
        padding: 2rem;
        border-radius: 1rem;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
    }

    .details-label {
        font-weight: 600;
        color: #adb5bd;
    }

    .btn-group a {
        min-width: 100px;
    }
</style>

<div class="container py-5">
    <div class="details-card">
        <h2 class="mb-4"><i class="bi bi-info-circle me-2"></i>Detalle Factura #@Model.FacturaId</h2>

        <dl class="row">
            <dt class="col-sm-3 details-label">Cliente</dt>
            <dd class="col-sm-9">@Model.Cliente?.Nombre</dd>
            <dt class="col-sm-3 details-label">Vehículo</dt>
            <dd class="col-sm-9">@(Model.Vehiculo?.Placa + (Model.Cliente != null ? $" — {Model.Cliente.Nombre}" : ""))</dd>
            <dt class="col-sm-3 details-label">Fecha</dt>
            <dd class="col-sm-9">@Model.Fecha.ToString("dd/MM/yyyy")</dd>
            <dt class="col-sm-3 details-label">Monto Total</dt>
            <dd class="col-sm-9">@montoCR</dd>
            <dt class="col-sm-3 details-label">Método de pago</dt>
            <dd class="col-sm-9">@Model.Metodo</dd>
        </dl>

        <div class="col-12">
            <h5 class="mt-3">Tareas realizadas al vehículo</h5>
            <div class="card shadow-sm">
                @{
                    var tareas = ViewBag.Tareas as IEnumerable<MecaFlow2025.Models.TareasVehiculo>;
                }
                @if (tareas != null)
                {
                    @await Html.PartialAsync("_TareasPorVehiculo", tareas)
                }
                else
                {
                    <div class="p-3 text-muted">No se pudieron cargar las tareas del vehículo.</div>
                }
            </div>
        </div>

        <div class="btn-group mt-4">
            <a asp-action="Edit" asp-route-id="@Model.FacturaId" class="btn btn-warning">
                <i class="bi bi-pencil-square me-1"></i>Editar
            </a>
            <a asp-action="Index" class="btn btn-outline-light ms-2">
                <i class="bi bi-arrow-left me-1"></i>Volver
            </a>
        </div>
    </div>
</div>