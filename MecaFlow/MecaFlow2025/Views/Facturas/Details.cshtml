@model MecaFlow2025.Models.Factura
@using System.Globalization

@{
    ViewData["Title"] = $"Detalle Factura #{Model.FacturaId}";
    string montoCR = Model.MontoTotal.ToString("C", new CultureInfo("es-CR"));
}

<h1>Detalle Factura #@Model.FacturaId</h1>

<div class="row g-3">
    <div class="col-md-4">
        <label class="form-label">Cliente</label>
        <input class="form-control" value="@Model.Cliente?.Nombre" readonly />
    </div>

    <div class="col-md-4">
        <label class="form-label">Vehículo</label>
        <input class="form-control" value="@(Model.Vehiculo?.Placa + (Model.Cliente != null ? $" — {Model.Cliente.Nombre}" : ""))" readonly />
    </div>

    <div class="col-md-4">
        <label class="form-label">Fecha</label>
        <input class="form-control" value="@Model.Fecha.ToString("dd/MM/yyyy")" readonly />
    </div>

    <div class="col-md-4">
        <label class="form-label">Monto Total</label>
        <input class="form-control" value="@montoCR" readonly />
    </div>

    <div class="col-md-4">
        <label class="form-label">Método de pago</label>
        <input class="form-control" value="@Model.Metodo" readonly />
    </div>


    <div class="col-12">
        <h5 class="mt-3">Tareas realizadas al vehículo</h5>
        <div class="card shadow-sm">
            @* Renderizamos el partial con las tareas que cargaste en el controlador *@
            @{
                var tareas = ViewBag.Tareas as IEnumerable<MecaFlow2025.Models.TareasVehiculo>;
            }
            @if (tareas != null)
            {
                @await Html.PartialAsync("_TareasPorVehiculo", tareas)
            }
            else
            {
                <div class="p-3 text-muted">No se pudieron cargar las tareas del vehículo.</div>
            }
        </div>
    </div>

    <div class="col-12 mt-3">
        <a asp-action="Index" class="btn btn-secondary">Volver</a>
    </div>
</div>
